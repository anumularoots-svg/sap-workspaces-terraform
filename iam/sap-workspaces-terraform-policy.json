{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "VPCNetworking",
      "Effect": "Allow",
      "Action": [
        "ec2:CreateVpc",
        "ec2:DeleteVpc",
        "ec2:DescribeVpcs",
        "ec2:ModifyVpcAttribute",
        "ec2:CreateSubnet",
        "ec2:DeleteSubnet",
        "ec2:DescribeSubnets",
        "ec2:CreateInternetGateway",
        "ec2:DeleteInternetGateway",
        "ec2:AttachInternetGateway",
        "ec2:DetachInternetGateway",
        "ec2:DescribeInternetGateways",
        "ec2:AllocateAddress",
        "ec2:ReleaseAddress",
        "ec2:DescribeAddresses",
        "ec2:CreateNatGateway",
        "ec2:DeleteNatGateway",
        "ec2:DescribeNatGateways",
        "ec2:CreateRouteTable",
        "ec2:DeleteRouteTable",
        "ec2:DescribeRouteTables",
        "ec2:CreateRoute",
        "ec2:DeleteRoute",
        "ec2:AssociateRouteTable",
        "ec2:DisassociateRouteTable",
        "ec2:CreateSecurityGroup",
        "ec2:DeleteSecurityGroup",
        "ec2:DescribeSecurityGroups",
        "ec2:AuthorizeSecurityGroupIngress",
        "ec2:AuthorizeSecurityGroupEgress",
        "ec2:RevokeSecurityGroupIngress",
        "ec2:RevokeSecurityGroupEgress",
        "ec2:CreateFlowLogs",
        "ec2:DeleteFlowLogs",
        "ec2:DescribeFlowLogs",
        "ec2:CreateTags",
        "ec2:DeleteTags",
        "ec2:DescribeTags",
        "ec2:DescribeAvailabilityZones",
        "ec2:DescribeNetworkInterfaces",
        "ec2:DescribeAccountAttributes"
      ],
      "Resource": "*",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "ap-south-1"
        }
      }
    },
    {
      "Sid": "EC2DescribeGlobal",
      "Effect": "Allow",
      "Action": [
        "ec2:DescribeAvailabilityZones",
        "ec2:DescribeAccountAttributes",
        "ec2:DescribeVpcs",
        "ec2:DescribeSubnets",
        "ec2:DescribeSecurityGroups",
        "ec2:DescribeInternetGateways",
        "ec2:DescribeNatGateways",
        "ec2:DescribeRouteTables",
        "ec2:DescribeAddresses",
        "ec2:DescribeFlowLogs",
        "ec2:DescribeNetworkInterfaces",
        "ec2:DescribeTags"
      ],
      "Resource": "*"
    },
    {
      "Sid": "DirectoryService",
      "Effect": "Allow",
      "Action": [
        "ds:CreateDirectory",
        "ds:DeleteDirectory",
        "ds:DescribeDirectories",
        "ds:CreateAlias",
        "ds:ListTagsForResource",
        "ds:AddTagsToResource",
        "ds:RemoveTagsFromResource",
        "ds:AuthorizeApplication",
        "ds:UnauthorizeApplication",
        "ds:DescribeConditionalForwarders"
      ],
      "Resource": "arn:aws:ds:ap-south-1:657246200133:directory/*"
    },
    {
      "Sid": "DirectoryServiceCreate",
      "Effect": "Allow",
      "Action": [
        "ds:CreateDirectory",
        "ds:DescribeDirectories",
        "ds:ListTagsForResource"
      ],
      "Resource": "*"
    },
    {
      "Sid": "WorkSpacesFullAccess",
      "Effect": "Allow",
      "Action": [
        "workspaces:*"
      ],
      "Resource": [
        "arn:aws:workspaces:ap-south-1:657246200133:directory/*",
        "arn:aws:workspaces:ap-south-1:657246200133:workspace/*",
        "arn:aws:workspaces:ap-south-1:657246200133:workspacebundle/*"
      ]
    },
    {
      "Sid": "WorkSpacesDescribe",
      "Effect": "Allow",
      "Action": [
        "workspaces:DescribeWorkspaces",
        "workspaces:DescribeWorkspaceDirectories",
        "workspaces:DescribeWorkspaceBundles",
        "workspaces:DescribeWorkspaceImages",
        "workspaces:DescribeTags",
        "workspaces:CreateWorkspaces",
        "workspaces:RegisterWorkspaceDirectory",
        "workspaces:DeregisterWorkspaceDirectory"
      ],
      "Resource": "*"
    },
    {
      "Sid": "LambdaManagement",
      "Effect": "Allow",
      "Action": [
        "lambda:CreateFunction",
        "lambda:DeleteFunction",
        "lambda:GetFunction",
        "lambda:GetFunctionConfiguration",
        "lambda:UpdateFunctionCode",
        "lambda:UpdateFunctionConfiguration",
        "lambda:InvokeFunction",
        "lambda:AddPermission",
        "lambda:RemovePermission",
        "lambda:GetPolicy",
        "lambda:ListVersionsByFunction",
        "lambda:ListTags",
        "lambda:TagResource",
        "lambda:UntagResource"
      ],
      "Resource": "arn:aws:lambda:ap-south-1:657246200133:function:sap-training-lab-*"
    },
    {
      "Sid": "EventBridgeScheduler",
      "Effect": "Allow",
      "Action": [
        "events:PutRule",
        "events:DeleteRule",
        "events:DescribeRule",
        "events:PutTargets",
        "events:RemoveTargets",
        "events:ListTargetsByRule",
        "events:ListTagsForResource",
        "events:TagResource",
        "events:UntagResource"
      ],
      "Resource": "arn:aws:events:ap-south-1:657246200133:rule/sap-training-lab-*"
    },
    {
      "Sid": "CloudWatchMonitoring",
      "Effect": "Allow",
      "Action": [
        "cloudwatch:PutDashboard",
        "cloudwatch:DeleteDashboards",
        "cloudwatch:GetDashboard",
        "cloudwatch:ListDashboards",
        "cloudwatch:PutMetricAlarm",
        "cloudwatch:DeleteAlarms",
        "cloudwatch:DescribeAlarms",
        "cloudwatch:ListTagsForResource",
        "cloudwatch:TagResource"
      ],
      "Resource": [
        "arn:aws:cloudwatch::657246200133:dashboard/sap-training-lab-*",
        "arn:aws:cloudwatch:ap-south-1:657246200133:alarm:sap-training-lab-*"
      ]
    },
    {
      "Sid": "CloudWatchLogs",
      "Effect": "Allow",
      "Action": [
        "logs:CreateLogGroup",
        "logs:DeleteLogGroup",
        "logs:DescribeLogGroups",
        "logs:PutRetentionPolicy",
        "logs:ListTagsLogGroup",
        "logs:ListTagsForResource",
        "logs:TagLogGroup",
        "logs:TagResource",
        "logs:UntagResource",
        "logs:CreateLogStream",
        "logs:PutLogEvents"
      ],
      "Resource": [
        "arn:aws:logs:ap-south-1:657246200133:log-group:/aws/lambda/sap-training-lab-*",
        "arn:aws:logs:ap-south-1:657246200133:log-group:/aws/vpc/flow-log/sap-training-lab-*",
        "arn:aws:logs:ap-south-1:657246200133:log-group:/aws/lambda/sap-training-lab-*:*",
        "arn:aws:logs:ap-south-1:657246200133:log-group:/aws/vpc/flow-log/sap-training-lab-*:*"
      ]
    },
    {
      "Sid": "SNSAlerts",
      "Effect": "Allow",
      "Action": [
        "sns:CreateTopic",
        "sns:DeleteTopic",
        "sns:GetTopicAttributes",
        "sns:SetTopicAttributes",
        "sns:Subscribe",
        "sns:Unsubscribe",
        "sns:ListSubscriptionsByTopic",
        "sns:ListTagsForResource",
        "sns:TagResource"
      ],
      "Resource": "arn:aws:sns:ap-south-1:657246200133:sap-training-lab-*"
    },
    {
      "Sid": "IAMRolesForLambdaAndFlowLogs",
      "Effect": "Allow",
      "Action": [
        "iam:CreateRole",
        "iam:DeleteRole",
        "iam:GetRole",
        "iam:PutRolePolicy",
        "iam:DeleteRolePolicy",
        "iam:GetRolePolicy",
        "iam:ListRolePolicies",
        "iam:ListAttachedRolePolicies",
        "iam:ListInstanceProfilesForRole",
        "iam:TagRole",
        "iam:PassRole"
      ],
      "Resource": [
        "arn:aws:iam::657246200133:role/sap-training-lab-*",
        "arn:aws:iam::657246200133:role/workspaces_DefaultRole"
      ]
    },
    {
      "Sid": "WorkSpacesServiceLinkedRole",
      "Effect": "Allow",
      "Action": [
        "iam:CreateServiceLinkedRole"
      ],
      "Resource": "arn:aws:iam::657246200133:role/aws-service-role/workspaces.amazonaws.com/AWSServiceRoleForWorkSpaces",
      "Condition": {
        "StringEquals": {
          "iam:AWSServiceName": "workspaces.amazonaws.com"
        }
      }
    },
    {
      "Sid": "S3TerraformState",
      "Effect": "Allow",
      "Action": [
        "s3:GetObject",
        "s3:PutObject",
        "s3:DeleteObject",
        "s3:ListBucket",
        "s3:GetBucketVersioning",
        "s3:GetBucketLocation"
      ],
      "Resource": [
        "arn:aws:s3:::lanciere-terraform-state-657246200133",
        "arn:aws:s3:::lanciere-terraform-state-657246200133/*"
      ]
    },
    {
      "Sid": "DynamoDBTerraformLock",
      "Effect": "Allow",
      "Action": [
        "dynamodb:GetItem",
        "dynamodb:PutItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable"
      ],
      "Resource": "arn:aws:dynamodb:ap-south-1:657246200133:table/terraform-lock"
    },
    {
      "Sid": "STSGetCaller",
      "Effect": "Allow",
      "Action": [
        "sts:GetCallerIdentity"
      ],
      "Resource": "*"
    }
  ]
}
